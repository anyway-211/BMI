#' Generating body condition level according to gender, age and BMI
#'
#' @param data data.frame
#' @param BMI numeric
#' @param gender numeric
#' @param age numeric
#'
#' @return a data.frame
#' @export
#'
#' @examples
#' data <- data.frame(BMI=18,gender=1,age=9)
#' BMI_level(data,BMI,gender,age)
BMI_level <- function(data,BMI,gender,age){
  library(tidyverse)
  data %>%
    mutate(BMI=round(BMI,1)) %>%
    mutate(BMI_level=ifelse(is.na(gender) | is.na(age) | is.na(BMI) | !(age %in% 6:120) | !(gender %in% c(1,2)),
                            "数据有误",NA)) %>%
    mutate(BMI_level=case_when(
      gender==1 & age>=6 & age<6.5 & BMI>=16.4 & BMI<17.7 ~ '超重',
      gender==1 & age>=6.5 & age<7 & BMI>=16.7 & BMI<18.1 ~ '超重',
      gender==1 & age>=7 & age<7.5 & BMI>=17 & BMI<18.7 ~ '超重',
      gender==1 & age>=7.5 & age<8 & BMI>=17.4 & BMI<19.2 ~ '超重',
      gender==1 & age>=8 & age<8.5 & BMI>=17.8 & BMI<19.7 ~ '超重',
      gender==1 & age>=8.5 & age<9 & BMI>=18.1 & BMI<20.3 ~ '超重',
      gender==1 & age>=9 & age<9.5 & BMI>=18.5 & BMI<20.8 ~ '超重',
      gender==1 & age>=9.5 & age<10 & BMI>=18.9 & BMI<21.4 ~ '超重',
      gender==1 & age>=10 & age<10.5 & BMI>=19.2 & BMI<21.9 ~ '超重',
      gender==1 & age>=10.5 & age<11 & BMI>=19.6 & BMI<22.5 ~ '超重',
      gender==1 & age>=11 & age<11.5 & BMI>=19.9 & BMI<23 ~ '超重',
      gender==1 & age>=11.5 & age<12 & BMI>=20.3 & BMI<23.6 ~ '超重',
      gender==1 & age>=12 & age<12.5 & BMI>=20.7 & BMI<24.1 ~ '超重',
      gender==1 & age>=12.5 & age<13 & BMI>=21 & BMI<24.7 ~ '超重',
      gender==1 & age>=13 & age<13.5 & BMI>=21.4 & BMI<25.2 ~ '超重',
      gender==1 & age>=13.5 & age<14 & BMI>=21.9 & BMI<25.7 ~ '超重',
      gender==1 & age>=14 & age<14.5 & BMI>=22.3 & BMI<26.1 ~ '超重',
      gender==1 & age>=14.5 & age<15 & BMI>=22.6 & BMI<26.4 ~ '超重',
      gender==1 & age>=15 & age<15.5 & BMI>=22.9 & BMI<26.6 ~ '超重',
      gender==1 & age>=15.5 & age<16 & BMI>=23.1 & BMI<26.9 ~ '超重',
      gender==1 & age>=16 & age<16.5 & BMI>=23.3 & BMI<27.1 ~ '超重',
      gender==1 & age>=16.5 & age<17 & BMI>=23.5 & BMI<27.4 ~ '超重',
      gender==1 & age>=17 & age<17.5 & BMI>=23.7 & BMI<27.6 ~ '超重',
      gender==1 & age>=17.5 & age<18 & BMI>=23.8 & BMI<27.8 ~ '超重',
      age>=18 & BMI>=24 & BMI<28 ~ '超重',
      gender==1 & age>=6 & age<6.5 & BMI>=17.7 ~ '肥胖',
      gender==1 & age>=6.5 & age<7 & BMI>=18.1 ~ '肥胖',
      gender==1 & age>=7 & age<7.5 & BMI>=18.7 ~ '肥胖',
      gender==1 & age>=7.5 & age<8 & BMI>=19.2 ~ '肥胖',
      gender==1 & age>=8 & age<8.5 & BMI>=19.7 ~ '肥胖',
      gender==1 & age>=8.5 & age<9 & BMI>=20.3 ~ '肥胖',
      gender==1 & age>=9 & age<9.5 & BMI>=20.8 ~ '肥胖',
      gender==1 & age>=9.5 & age<10 & BMI>=21.4 ~ '肥胖',
      gender==1 & age>=10 & age<10.5 & BMI>=21.9 ~ '肥胖',
      gender==1 & age>=10.5 & age<11 & BMI>=22.5 ~ '肥胖',
      gender==1 & age>=11 & age<11.5 & BMI>=23 ~ '肥胖',
      gender==1 & age>=11.5 & age<12 & BMI>=23.6 ~ '肥胖',
      gender==1 & age>=12 & age<12.5 & BMI>=24.1 ~ '肥胖',
      gender==1 & age>=12.5 & age<13 & BMI>=24.7 ~ '肥胖',
      gender==1 & age>=13 & age<13.5 & BMI>=25.2 ~ '肥胖',
      gender==1 & age>=13.5 & age<14 & BMI>=25.7 ~ '肥胖',
      gender==1 & age>=14 & age<14.5 & BMI>=26.1 ~ '肥胖',
      gender==1 & age>=14.5 & age<15 & BMI>=26.4 ~ '肥胖',
      gender==1 & age>=15 & age<15.5 & BMI>=26.6 ~ '肥胖',
      gender==1 & age>=15.5 & age<16 & BMI>=26.9 ~ '肥胖',
      gender==1 & age>=16 & age<16.5 & BMI>=27.1 ~ '肥胖',
      gender==1 & age>=16.5 & age<17 & BMI>=27.4 ~ '肥胖',
      gender==1 & age>=17 & age<17.5 & BMI>=27.6 ~ '肥胖',
      gender==1 & age>=17.5 & age<18 & BMI>=27.8 ~ '肥胖',
      age>=18& BMI>=28 ~ '肥胖',
      gender==2 & age>=6 & age<6.5 & BMI>=16.2 & BMI<17.5 ~ '超重',
      gender==2 & age>=6.5 & age<7 & BMI>=16.5 & BMI<18 ~ '超重',
      gender==2 & age>=7 & age<7.5 & BMI>=16.8 & BMI<18.5 ~ '超重',
      gender==2 & age>=7.5 & age<8 & BMI>=17.2 & BMI<19 ~ '超重',
      gender==2 & age>=8 & age<8.5 & BMI>=17.6 & BMI<19.4 ~ '超重',
      gender==2 & age>=8.5 & age<9 & BMI>=18.1 & BMI<19.9 ~ '超重',
      gender==2 & age>=9 & age<9.5 & BMI>=18.5 & BMI<20.4 ~ '超重',
      gender==2 & age>=9.5 & age<10 & BMI>=19 & BMI<21 ~ '超重',
      gender==2 & age>=10 & age<10.5 & BMI>=19.5 & BMI<21.5 ~ '超重',
      gender==2 & age>=10.5 & age<11 & BMI>=20 & BMI<22.1 ~ '超重',
      gender==2 & age>=11 & age<11.5 & BMI>=20.5 & BMI<22.7 ~ '超重',
      gender==2 & age>=11.5 & age<12 & BMI>=21.1 & BMI<23.3 ~ '超重',
      gender==2 & age>=12 & age<12.5 & BMI>=21.5 & BMI<23.9 ~ '超重',
      gender==2 & age>=12.5 & age<13 & BMI>=21.9 & BMI<24.5 ~ '超重',
      gender==2 & age>=13 & age<13.5 & BMI>=22.2 & BMI<25 ~ '超重',
      gender==2 & age>=13.5 & age<14 & BMI>=22.6 & BMI<25.6 ~ '超重',
      gender==2 & age>=14 & age<14.5 & BMI>=22.8 & BMI<25.9 ~ '超重',
      gender==2 & age>=14.5 & age<15 & BMI>=23 & BMI<26.3 ~ '超重',
      gender==2 & age>=15 & age<15.5 & BMI>=23.2 & BMI<26.6 ~ '超重',
      gender==2 & age>=15.5 & age<16 & BMI>=23.4 & BMI<26.9 ~ '超重',
      gender==2 & age>=16 & age<16.5 & BMI>=23.6 & BMI<27.1 ~ '超重',
      gender==2 & age>=16.5 & age<17 & BMI>=23.7 & BMI<27.4 ~ '超重',
      gender==2 & age>=17 & age<17.5 & BMI>=23.8 & BMI<27.6 ~ '超重',
      gender==2 & age>=17.5 & age<18 & BMI>=23.9 & BMI<27.8 ~ '超重',
      gender==2 & age>=6 & age<6.5 & BMI>=17.5 ~ '肥胖',
      gender==2 & age>=6.5 & age<7 & BMI>=18 ~ '肥胖',
      gender==2 & age>=7 & age<7.5 & BMI>=18.5 ~ '肥胖',
      gender==2 & age>=7.5 & age<8 & BMI>=19 ~ '肥胖',
      gender==2 & age>=8 & age<8.5 & BMI>=19.4 ~ '肥胖',
      gender==2 & age>=8.5 & age<9 & BMI>=19.9 ~ '肥胖',
      gender==2 & age>=9 & age<9.5 & BMI>=20.4 ~ '肥胖',
      gender==2 & age>=9.5 & age<10 & BMI>=21 ~ '肥胖',
      gender==2 & age>=10 & age<10.5 & BMI>=21.5 ~ '肥胖',
      gender==2 & age>=10.5 & age<11 & BMI>=22.1 ~ '肥胖',
      gender==2 & age>=11 & age<11.5 & BMI>=22.7 ~ '肥胖',
      gender==2 & age>=11.5 & age<12 & BMI>=23.3 ~ '肥胖',
      gender==2 & age>=12 & age<12.5 & BMI>=23.9 ~ '肥胖',
      gender==2 & age>=12.5 & age<13 & BMI>=24.5 ~ '肥胖',
      gender==2 & age>=13 & age<13.5 & BMI>=25 ~ '肥胖',
      gender==2 & age>=13.5 & age<14 & BMI>=25.6 ~ '肥胖',
      gender==2 & age>=14 & age<14.5 & BMI>=25.9 ~ '肥胖',
      gender==2 & age>=14.5 & age<15 & BMI>=26.3 ~ '肥胖',
      gender==2 & age>=15 & age<15.5 & BMI>=26.6 ~ '肥胖',
      gender==2 & age>=15.5 & age<16 & BMI>=26.9 ~ '肥胖',
      gender==2 & age>=16 & age<16.5 & BMI>=27.1 ~ '肥胖',
      gender==2 & age>=16.5 & age<17 & BMI>=27.4 ~ '肥胖',
      gender==2 & age>=17 & age<17.5 & BMI>=27.6 ~ '肥胖',
      gender==2 & age>=17.5 & age<18 & BMI>=27.8 ~ '肥胖',
      gender==1 & age>=6 & age<=6.5 & BMI>=13.3 & BMI<=13.4 ~ '轻度消瘦',
      gender==1 & age>=6.5 & age<=7 & BMI>=13.5 & BMI<=13.8 ~ '轻度消瘦',
      gender==1 & age>=7 & age<=7.5 & BMI>=13.6 & BMI<=13.9 ~ '轻度消瘦',
      gender==1 & age>=7.5 & age<=8 & BMI>=13.6 & BMI<=13.9 ~ '轻度消瘦',
      gender==1 & age>=8 & age<=8.5 & BMI>=13.7 & BMI<=14 ~ '轻度消瘦',
      gender==1 & age>=8.5 & age<=9 & BMI>=13.7 & BMI<=14 ~ '轻度消瘦',
      gender==1 & age>=9 & age<=9.5 & BMI>=13.8 & BMI<=14.1 ~ '轻度消瘦',
      gender==1 & age>=9.5 & age<=10 & BMI>=13.9 & BMI<=14.2 ~ '轻度消瘦',
      gender==1 & age>=10 & age<=10.5 & BMI>=14 & BMI<=14.4 ~ '轻度消瘦',
      gender==1 & age>=10.5 & age<=11 & BMI>=14.1 & BMI<=14.6 ~ '轻度消瘦',
      gender==1 & age>=11 & age<=11.5 & BMI>=14.3 & BMI<=14.9 ~ '轻度消瘦',
      gender==1 & age>=11.5 & age<=12 & BMI>=14.4 & BMI<=15.1 ~ '轻度消瘦',
      gender==1 & age>=12 & age<=12.5 & BMI>=14.5 & BMI<=15.4 ~ '轻度消瘦',
      gender==1 & age>=12.5 & age<=13 & BMI>=14.6 & BMI<=15.6 ~ '轻度消瘦',
      gender==1 & age>=13 & age<=13.5 & BMI>=14.9 & BMI<=15.9 ~ '轻度消瘦',
      gender==1 & age>=13.5 & age<=14 & BMI>=15.1 & BMI<=16.1 ~ '轻度消瘦',
      gender==1 & age>=14 & age<=14.5 & BMI>=15.4 & BMI<=16.4 ~ '轻度消瘦',
      gender==1 & age>=14.5 & age<=15 & BMI>=15.6 & BMI<=16.7 ~ '轻度消瘦',
      gender==1 & age>=15 & age<=15.5 & BMI>=15.9 & BMI<=16.9 ~ '轻度消瘦',
      gender==1 & age>=15.5 & age<=16 & BMI>=16.1 & BMI<=17 ~ '轻度消瘦',
      gender==1 & age>=16 & age<=16.5 & BMI>=16.3 & BMI<=17.3 ~ '轻度消瘦',
      gender==1 & age>=16.5 & age<=17 & BMI>=16.5 & BMI<=17.5 ~ '轻度消瘦',
      gender==1 & age>=17 & age<=17.5 & BMI>=16.7 & BMI<=17.7 ~ '轻度消瘦',
      gender==1 & age>=17.5 & BMI>=16.9 & BMI<=17.9 ~ '轻度消瘦',
      gender==1 & age>=6 & age<=6.5 & BMI<13.3 ~ '中重度消瘦',
      gender==1 & age>=6.5 & age<=7 & BMI<13.5 ~ '中重度消瘦',
      gender==1 & age>=7 & age<=7.5 & BMI<13.6 ~ '中重度消瘦',
      gender==1 & age>=7.5 & age<=8 & BMI<13.6 ~ '中重度消瘦',
      gender==1 & age>=8 & age<=8.5 & BMI<13.7 ~ '中重度消瘦',
      gender==1 & age>=8.5 & age<=9 & BMI<13.7 ~ '中重度消瘦',
      gender==1 & age>=9 & age<=9.5 & BMI<13.8 ~ '中重度消瘦',
      gender==1 & age>=9.5 & age<=10 & BMI<13.9 ~ '中重度消瘦',
      gender==1 & age>=10 & age<=10.5 & BMI<14 ~ '中重度消瘦',
      gender==1 & age>=10.5 & age<=11 & BMI<14.1 ~ '中重度消瘦',
      gender==1 & age>=11 & age<=11.5 & BMI<14.3 ~ '中重度消瘦',
      gender==1 & age>=11.5 & age<=12 & BMI<14.4 ~ '中重度消瘦',
      gender==1 & age>=12 & age<=12.5 & BMI<14.5 ~ '中重度消瘦',
      gender==1 & age>=12.5 & age<=13 & BMI<14.6 ~ '中重度消瘦',
      gender==1 & age>=13 & age<=13.5 & BMI<14.9 ~ '中重度消瘦',
      gender==1 & age>=13.5 & age<=14 & BMI<15.1 ~ '中重度消瘦',
      gender==1 & age>=14 & age<=14.5 & BMI<15.4 ~ '中重度消瘦',
      gender==1 & age>=14.5 & age<=15 & BMI<15.6 ~ '中重度消瘦',
      gender==1 & age>=15 & age<=15.5 & BMI<15.9 ~ '中重度消瘦',
      gender==1 & age>=15.5 & age<=16 & BMI<16.1 ~ '中重度消瘦',
      gender==1 & age>=16 & age<=16.5 & BMI<16.3 ~ '中重度消瘦',
      gender==1 & age>=16.5 & age<=17 & BMI<16.5 ~ '中重度消瘦',
      gender==1 & age>=17 & age<=17.5 & BMI<16.7 ~ '中重度消瘦',
      gender==1 & age>=17.5 & BMI<16.9 ~ '中重度消瘦',
      gender==2 & age>=6 & age<=6.5 & BMI>=12.9 & BMI<=13.1 ~ '轻度消瘦',
      gender==2 & age>=6.5 & age<=7 & BMI>=13 & BMI<=13.3 ~ '轻度消瘦',
      gender==2 & age>=7 & age<=7.5 & BMI>=13.1 & BMI<=13.4 ~ '轻度消瘦',
      gender==2 & age>=7.5 & age<=8 & BMI>=13.1 & BMI<=13.5 ~ '轻度消瘦',
      gender==2 & age>=8 & age<=8.5 & BMI>=13.2 & BMI<=13.6 ~ '轻度消瘦',
      gender==2 & age>=8.5 & age<=9 & BMI>=13.2 & BMI<=13.7 ~ '轻度消瘦',
      gender==2 & age>=9 & age<=9.5 & BMI>=13.3 & BMI<=13.8 ~ '轻度消瘦',
      gender==2 & age>=9.5 & age<=10 & BMI>=13.3 & BMI<=13.9 ~ '轻度消瘦',
      gender==2 & age>=10 & age<=10.5 & BMI>=13.4 & BMI<=14 ~ '轻度消瘦',
      gender==2 & age>=10.5 & age<=11 & BMI>=13.5 & BMI<=14.1 ~ '轻度消瘦',
      gender==2 & age>=11 & age<=11.5 & BMI>=13.8 & BMI<=14.3 ~ '轻度消瘦',
      gender==2 & age>=11.5 & age<=12 & BMI>=14 & BMI<=14.5 ~ '轻度消瘦',
      gender==2 & age>=12 & age<=12.5 & BMI>=14.2 & BMI<=14.7 ~ '轻度消瘦',
      gender==2 & age>=12.5 & age<=13 & BMI>=14.4 & BMI<=14.9 ~ '轻度消瘦',
      gender==2 & age>=13 & age<=13.5 & BMI>=14.7 & BMI<=15.3 ~ '轻度消瘦',
      gender==2 & age>=13.5 & age<=14 & BMI>=15 & BMI<=15.6 ~ '轻度消瘦',
      gender==2 & age>=14 & age<=14.5 & BMI>=15.4 & BMI<=16 ~ '轻度消瘦',
      gender==2 & age>=14.5 & age<=15 & BMI>=15.8 & BMI<=16.3 ~ '轻度消瘦',
      gender==2 & age>=15 & age<=15.5 & BMI>=16.1 & BMI<=16.6 ~ '轻度消瘦',
      gender==2 & age>=15.5 & age<=16 & BMI>=16.3 & BMI<=16.8 ~ '轻度消瘦',
      gender==2 & age>=16 & age<=16.5 & BMI>=16.5 & BMI<=17 ~ '轻度消瘦',
      gender==2 & age>=16.5 & age<=17 & BMI>=16.6 & BMI<=17.1 ~ '轻度消瘦',
      gender==2 & age>=17 & age<=17.5 & BMI>=16.7 & BMI<=17.2 ~ '轻度消瘦',
      gender==2 & age>=17.5 & BMI>=16.8 & BMI<=17.3 ~ '轻度消瘦',
      gender==2 & age>=6 & age<=6.5 & BMI<12.9 ~ '中重度消瘦',
      gender==2 & age>=6.5 & age<=7 & BMI<13 ~ '中重度消瘦',
      gender==2 & age>=7 & age<=7.5 & BMI<13.1 ~ '中重度消瘦',
      gender==2 & age>=7.5 & age<=8 & BMI<13.1 ~ '中重度消瘦',
      gender==2 & age>=8 & age<=8.5 & BMI<13.2 ~ '中重度消瘦',
      gender==2 & age>=8.5 & age<=9 & BMI<13.2 ~ '中重度消瘦',
      gender==2 & age>=9 & age<=9.5 & BMI<13.3 ~ '中重度消瘦',
      gender==2 & age>=9.5 & age<=10 & BMI<13.3 ~ '中重度消瘦',
      gender==2 & age>=10 & age<=10.5 & BMI<13.4 ~ '中重度消瘦',
      gender==2 & age>=10.5 & age<=11 & BMI<13.5 ~ '中重度消瘦',
      gender==2 & age>=11 & age<=11.5 & BMI<13.8 ~ '中重度消瘦',
      gender==2 & age>=11.5 & age<=12 & BMI<14 ~ '中重度消瘦',
      gender==2 & age>=12 & age<=12.5 & BMI<14.2 ~ '中重度消瘦',
      gender==2 & age>=12.5 & age<=13 & BMI<14.4 ~ '中重度消瘦',
      gender==2 & age>=13 & age<=13.5 & BMI<14.7 ~ '中重度消瘦',
      gender==2 & age>=13.5 & age<=14 & BMI<15 ~ '中重度消瘦',
      gender==2 & age>=14 & age<=14.5 & BMI<15.4 ~ '中重度消瘦',
      gender==2 & age>=14.5 & age<=15 & BMI<15.8 ~ '中重度消瘦',
      gender==2 & age>=15 & age<=15.5 & BMI<16.1 ~ '中重度消瘦',
      gender==2 & age>=15.5 & age<=16 & BMI<16.3 ~ '中重度消瘦',
      gender==2 & age>=16 & age<=16.5 & BMI<16.5 ~ '中重度消瘦',
      gender==2 & age>=16.5 & age<=17 & BMI<16.6 ~ '中重度消瘦',
      gender==2 & age>=17 & age<=17.5 & BMI<16.7 ~ '中重度消瘦',
      gender==2 & age>=17.5 & BMI<16.8 ~ '中重度消瘦',
      TRUE ~ "正常"
    ))
}
